<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlackVip Casino | Ultra Premium Definitive</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        /* --- VARIABLES DE DISE√ëO PREMIUM --- */
        :root {
            --gold: #c5a059;
            --gold-light: #e9d5a3;
            --gold-dark: #8a6d3b;
            --purple-vip: #4b0082;
            --black-bg: #050505;
            --dark-gray: #121212;
            --white: #ffffff;
            --red-casino: #d32f2f;
            --green-casino: #2e7d32;
            --ocre: #8b4513;
            --shadow-gold: rgba(197, 160, 89, 0.3);
        }

        /* --- ESTILOS BASE --- */
        body { 
            background-color: var(--black-bg); 
            color: var(--white); 
            font-family: 'Poppins', sans-serif; 
            margin: 0; 
            background-image: radial-gradient(circle at center, #1a0033 0%, #050505 100%);
            min-height: 100vh; 
            overflow-x: hidden;
        }

        h1, h2, h3, .logo { 
            font-family: 'Cinzel', serif; 
            letter-spacing: 3px; 
            text-transform: uppercase; 
            color: var(--gold);
        }

        /* --- PANTALLA DE ACCESO --- */
        #auth-container { 
            position: fixed; 
            inset: 0; 
            background: var(--black-bg); 
            z-index: 5000; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
        }

        .auth-box { 
            background: rgba(15, 15, 15, 0.98); 
            padding: 60px; 
            border-radius: 12px; 
            border: 2px solid var(--gold); 
            text-align: center; 
            width: 420px; 
            box-shadow: 0 0 60px var(--shadow-gold);
        }

        .auth-box input { 
            width: 100%; 
            padding: 16px; 
            margin: 15px 0; 
            border: none; 
            border-bottom: 2px solid var(--gold);
            background: rgba(255, 255, 255, 0.03); 
            color: #fff; 
            outline: none; 
            box-sizing: border-box; 
            font-size: 1rem;
            transition: 0.3s;
        }

        .auth-box input:focus {
            background: rgba(197, 160, 89, 0.1);
            border-bottom-color: var(--gold-light);
        }

        /* --- NAVEGACI√ìN Y HEADER --- */
        header { 
            display: none; 
            justify-content: space-around; 
            align-items: center; 
            padding: 25px 0;
            background: rgba(0, 0, 0, 0.9); 
            border-bottom: 1px solid var(--gold);
            position: sticky; 
            top: 0; 
            z-index: 1000; 
            backdrop-filter: blur(20px);
        }

        .balance-card { 
            background: linear-gradient(145deg, var(--gold), var(--gold-dark)); 
            color: black; 
            padding: 12px 35px; 
            border-radius: 6px; 
            font-weight: 800; 
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.6), inset 0 0 10px rgba(255,255,255,0.4);
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .balance-card:hover { 
            transform: scale(1.08) translateY(-2px); 
            box-shadow: 0 8px 25px var(--shadow-gold);
        }

        /* --- DISE√ëO DEL LOBBY --- */
        #main-content { 
            display: none; 
            flex-direction: column; 
            align-items: center; 
            padding: 50px 20px; 
        }

        .lobby { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 30px; 
            width: 100%; 
            max-width: 1250px; 
        }

        @media (max-width: 950px) { .lobby { grid-template-columns: 1fr 1fr; } }
        @media (max-width: 600px) { .lobby { grid-template-columns: 1fr; } }

        .game-card { 
            background: var(--dark-gray); 
            position: relative; 
            border-radius: 15px; 
            overflow: hidden;
            cursor: pointer; 
            transition: 0.5s ease; 
            border: 1px solid #222; 
            height: 220px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.5);
        }

        .game-card:hover { 
            transform: translateY(-15px); 
            border-color: var(--gold); 
            box-shadow: 0 20px 50px var(--shadow-gold);
        }

        .game-card img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            opacity: 0.35; 
            transition: 0.7s; 
        }

        .game-card:hover img { 
            opacity: 0.7; 
            transform: scale(1.15); 
        }

        .game-card h3 { 
            position: absolute; 
            bottom: 25px; 
            left: 25px; 
            color: var(--gold-light); 
            margin: 0; 
            text-shadow: 3px 3px 10px black; 
            font-size: 1.5rem;
        }

        /* --- VENTANAS MODALES --- */
        .modal { 
            display: none; 
            position: fixed; 
            inset: 0; 
            background: rgba(0, 0, 0, 0.98); 
            z-index: 2000; 
            align-items: center; 
            justify-content: center; 
            backdrop-filter: blur(15px);
        }

        .game-window { 
            background: #0a0a0a; 
            width: 95%; 
            max-width: 900px; 
            padding: 50px; 
            border: 1px solid var(--gold); 
            position: relative; 
            max-height: 90vh; 
            overflow-y: auto; 
            border-radius: 12px;
            box-shadow: 0 0 100px rgba(0,0,0,1);
        }

        .close-modal { 
            position: absolute; 
            top: 25px; 
            right: 30px; 
            color: var(--gold); 
            font-size: 3rem; 
            cursor: pointer; 
            line-height: 1;
        }

        /* --- COMPONENTES DE JUEGO --- */
        .status-msg { 
            font-size: 1.5rem; 
            color: var(--gold); 
            margin-bottom: 30px; 
            font-weight: 700; 
            text-align: center; 
            text-transform: uppercase; 
            min-height: 40px; 
            letter-spacing: 2px;
        }

        .win-anim { color: var(--green-casino) !important; text-shadow: 0 0 20px var(--green-casino); }
        .lose-anim { color: var(--red-casino) !important; text-shadow: 0 0 20px var(--red-casino); }

        .btn { 
            padding: 18px 35px; 
            border: none; 
            cursor: pointer; 
            font-family: 'Cinzel'; 
            font-weight: 800; 
            transition: 0.3s; 
            margin: 10px; 
            border-radius: 5px; 
            text-transform: uppercase; 
            font-size: 1rem;
        }

        .btn-gold { 
            background: linear-gradient(to bottom, var(--gold-light), var(--gold)); 
            color: black; 
            box-shadow: 0 5px 0 var(--gold-dark); 
        }

        .btn-gold:active { 
            transform: translateY(4px); 
            box-shadow: none; 
        }

        .btn-outline { 
            background: transparent; 
            border: 2px solid var(--gold); 
            color: var(--gold); 
        }

        .btn-outline:hover { 
            background: var(--gold); 
            color: black; 
        }

        /* --- RULETA INTERCALADA PROFESIONAL --- */
        .wheel-container { 
            position: relative; 
            width: 320px; 
            height: 320px; 
            margin: 40px auto; 
        }

        #r-wheel { 
            width: 100%; 
            height: 100%; 
            border-radius: 50%; 
            border: 15px solid #1a1a1a; 
            box-shadow: 0 0 50px rgba(0,0,0,0.9), inset 0 0 30px rgba(0,0,0,0.7);
            transition: 6s cubic-bezier(0.1, 0, 0.1, 1);
            background: conic-gradient(
                #2e7d32 0deg 9.7deg,
                #d32f2f 9.7deg 19.4deg, #111 19.4deg 29.1deg, #d32f2f 29.1deg 38.8deg, #111 38.8deg 48.5deg,
                #d32f2f 48.5deg 58.2deg, #111 58.2deg 67.9deg, #d32f2f 67.9deg 77.6deg, #111 77.6deg 87.3deg,
                #d32f2f 87.3deg 97deg, #111 97deg 106.7deg, #d32f2f 106.7deg 116.4deg, #111 116.4deg 126.1deg,
                #d32f2f 126.1deg 135.8deg, #111 135.8deg 145.5deg, #d32f2f 145.5deg 155.2deg, #111 155.2deg 164.9deg,
                #d32f2f 164.9deg 174.6deg, #111 174.6deg 184.3deg, #d32f2f 184.3deg 194deg, #111 194deg 203.7deg,
                #d32f2f 203.7deg 213.4deg, #111 213.4deg 223.1deg, #d32f2f 223.1deg 232.8deg, #111 232.8deg 242.5deg,
                #d32f2f 242.5deg 252.2deg, #111 252.2deg 261.9deg, #d32f2f 261.9deg 271.6deg, #111 271.6deg 281.3deg,
                #d32f2f 281.3deg 291deg, #111 291deg 300.7deg, #d32f2f 300.7deg 310.4deg, #111 310.4deg 320.1deg,
                #d32f2f 320.1deg 329.8deg, #111 329.8deg 339.5deg, #d32f2f 339.5deg 349.2deg, #111 349.2deg 360deg
            );
        }

        .wheel-pointer { 
            position: absolute; 
            top: -15px; 
            left: 50%; 
            transform: translateX(-50%);
            width: 0; 
            height: 0; 
            border-left: 20px solid transparent; 
            border-right: 20px solid transparent;
            border-top: 40px solid var(--gold); 
            z-index: 50; 
            filter: drop-shadow(0 0 10px black);
        }

        /* --- CAJERO Y TABLAS --- */
        .bank-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 30px; 
            margin-top: 30px; 
        }

        .bank-card { 
            background: #111; 
            padding: 30px; 
            border-radius: 10px; 
            border: 1px solid #333; 
            border-top: 4px solid var(--gold);
        }

        .history-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-top: 30px; 
            color: #ccc;
        }

        .history-table th { 
            background: #1a1a1a; 
            color: var(--gold); 
            padding: 15px; 
            text-transform: uppercase; 
            font-size: 0.8rem;
            border-bottom: 2px solid var(--gold);
        }

        .history-table td { 
            padding: 12px; 
            text-align: center; 
            border-bottom: 1px solid #222; 
        }
    </style>
</head>
<body>

    <div id="auth-container">
        <div class="auth-box">
            <h1 id="auth-main-title">BLACK VIP CASINO</h1>
            <p style="color:#666; font-size: 0.7rem; margin-bottom: 20px;">EXCLUSIVE ACCESS ONLY</p>
            <input type="text" id="user-in" placeholder="NOMBRE DE SOCIO">
            <input type="password" id="pass-in" placeholder="C√ìDIGO SECRETO">
            <div id="reg-fields" style="display:none">
                <input type="text" id="bank-in" placeholder="DATOS DE PAGO M√ìVIL / BANCO">
            </div>
            <button class="btn btn-gold" style="width:100%; margin-top:20px;" onclick="processAuth()">INICIAR SESI√ìN</button>
            <p style="font-size: 0.8rem; margin-top:30px; cursor:pointer; color:var(--gold); font-weight: 600;" onclick="toggleAuth()">¬øSOLICITAR NUEVA MEMBRES√çA?</p>
        </div>
    </div>

    <header id="vip-header">
        <div class="logo">BLACK VIP</div>
        <div class="balance-card" onclick="openBank()">
            <span style="font-size:0.6rem; display:block; opacity: 0.8;">SALDO DISPONIBLE</span>
            <span id="bal-val">0</span> <small>BC</small>
        </div>
        <div style="color:var(--gold); cursor:pointer; font-weight:700; font-size:0.9rem; border-bottom: 1px solid var(--gold);" onclick="location.reload()">CERRAR SESI√ìN</div>
    </header>

    <div id="main-content">
        <div class="lobby">
            <div class="game-card" onclick="openGame('ruleta')">
                <img src="https://images.unsplash.com/photo-1606167668584-78701c57f13d?w=600">
                <h3>RULETA ROYAL</h3>
            </div>
            <div class="game-card" onclick="openGame('blackjack')">
                <img src="https://images.unsplash.com/photo-1511193311914-0346f16efe90?w=600">
                <h3>BLACKJACK 21</h3>
            </div>
            <div class="game-card" onclick="openGame('aviator')">
                <img src="https://images.unsplash.com/photo-1559136555-9303baea8ebd?w=600">
                <h3>AVIATOR PRO</h3>
            </div>
            <div class="game-card" onclick="openGame('slots')">
                <img src="https://images.unsplash.com/photo-1596838132731-3301c3fd4317?w=600">
                <h3>LUCKY SLOTS</h3>
            </div>
            <div class="game-card" onclick="openGame('mines')">
                <img src="https://images.unsplash.com/photo-1614028674026-a65e31bfd27c?w=600">
                <h3>MINAS VIP</h3>
            </div>
            <div class="game-card" onclick="openBank()">
                <img src="https://images.unsplash.com/photo-1554118811-1e0d58224f24?w=600">
                <h3>CAJERO VIP</h3>
            </div>
        </div>
    </div>

    <div id="modal-ruleta" class="modal">
        <div class="game-window">
            <span class="close-modal" onclick="closeAll()">√ó</span>
            <h2>RULETA ROYAL</h2>
            <div id="r-status" class="status-msg">SELECCIONE UN COLOR PARA APOSTAR</div>
            
            <div class="wheel-container">
                <div class="wheel-pointer"></div>
                <div id="r-wheel"></div>
            </div>

            <div style="text-align:center; margin-top:50px;">
                <button class="btn btn-gold" style="background:var(--red-casino); color:white; border:none;" onclick="playR('rojo')">APOSTAR ROJO (X2)</button>
                <button class="btn btn-gold" style="background:#111; color:white; border:1px solid var(--gold);" onclick="playR('negro')">APOSTAR NEGRO (X2)</button>
            </div>
        </div>
    </div>

    <div id="modal-blackjack" class="modal">
        <div class="game-window">
            <span class="close-modal" onclick="closeAll()">√ó</span>
            <h2>BLACKJACK 21</h2>
            <div id="b-status" class="status-msg">ESPERANDO APUESTA INICIAL</div>
            
            <div style="background:#0a3d1e; padding:40px; border:10px solid var(--ocre); border-radius:50px; box-shadow: inset 0 0 100px black;">
                <div style="text-align:center; color:rgba(255,255,255,0.5); font-size:0.8rem; margin-bottom:10px;">MANO DE LA CASA</div>
                <div id="b-dealer" style="display:flex; justify-content:center; gap:15px; min-height:110px;"></div>
                <hr style="border:none; border-top:1px dashed rgba(255,255,255,0.2); margin:30px 0;">
                <div style="text-align:center; color:rgba(255,255,255,0.5); font-size:0.8rem; margin-bottom:10px;">TU MANO</div>
                <div id="b-player" style="display:flex; justify-content:center; gap:15px; min-height:110px;"></div>
            </div>

            <div style="text-align:center; margin-top:40px;">
                <button id="b-start" class="btn btn-gold" onclick="startB()">APOSTAR 50 BC</button>
                <button id="b-hit" class="btn btn-outline" onclick="hitB()" disabled>PEDIR CARTA</button>
                <button id="b-stand" class="btn btn-outline" onclick="standB()" disabled>PLANTARSE</button>
            </div>
        </div>
    </div>

    <div id="modal-aviator" class="modal">
        <div class="game-window">
            <span class="close-modal" onclick="closeAll()">√ó</span>
            <h2>AVIATOR PRO</h2>
            <div id="c-status" class="status-msg">ESPERANDO DESPEGUE</div>
            <div id="c-mult" style="font-size:7rem; text-align:center; color:var(--gold); font-weight:900; text-shadow: 0 0 30px var(--purple-vip);">1.00x</div>
            <div style="text-align:center; margin-top:30px;">
                <button id="c-start" class="btn btn-gold" onclick="startC()">APOSTAR 100 BC</button>
                <button id="c-cash" class="btn btn-outline" onclick="cashC()" disabled>RETIRAR GANANCIAS</button>
            </div>
        </div>
    </div>

    <div id="modal-slots" class="modal">
        <div class="game-window">
            <span class="close-modal" onclick="closeAll()">√ó</span>
            <h2>LUCKY SLOTS</h2>
            <div id="s-status" class="status-msg">JACKPOT: 500 BC</div>
            <div style="display:flex; justify-content:center; gap:20px; margin:50px 0;">
                <div id="sl1" style="width:100px; height:130px; background:white; color:black; font-size:4rem; display:flex; align-items:center; justify-content:center; border-radius:10px; border:5px solid var(--gold);">üíé</div>
                <div id="sl2" style="width:100px; height:130px; background:white; color:black; font-size:4rem; display:flex; align-items:center; justify-content:center; border-radius:10px; border:5px solid var(--gold);">üíé</div>
                <div id="sl3" style="width:100px; height:130px; background:white; color:black; font-size:4rem; display:flex; align-items:center; justify-content:center; border-radius:10px; border:5px solid var(--gold);">üíé</div>
            </div>
            <div style="text-align:center;">
                <button class="btn btn-gold" onclick="playS()">GIRAR RODILLOS (20 BC)</button>
            </div>
        </div>
    </div>

    <div id="modal-mines" class="modal">
        <div class="game-window">
            <span class="close-modal" onclick="closeAll()">√ó</span>
            <h2>MINAS VIP</h2>
            <div id="m-status" class="status-msg">ENCUENTRA LOS DIAMANTES</div>
            <div id="m-grid" style="display:grid; grid-template-columns:repeat(5, 1fr); gap:12px; max-width:450px; margin:auto;"></div>
            <div style="text-align:center; margin-top:40px;">
                <button id="m-start" class="btn btn-gold" onclick="startM()">NUEVA PARTIDA (100 BC)</button>
                <button id="m-cash" class="btn btn-outline" onclick="cashM()" disabled>COBRAR BC</button>
            </div>
        </div>
    </div>

    <div id="modal-bank" class="modal">
        <div class="game-window" style="max-width:950px;">
            <span class="close-modal" onclick="closeAll()">√ó</span>
            <h2>CENTRO DE OPERACIONES CAJERO VIP</h2>
            
            <div class="bank-grid">
                <div class="bank-card">
                    <h3 style="font-size:1.1rem; margin-top:0;">RECARGAR SALDO</h3>
                    <p style="font-size:0.8rem; color:#888;">Transfiere a la cuenta oficial y reporta tu pago para recibir BC instant√°neamente.</p>
                    <div style="background:#000; padding:20px; border-radius:5px; font-size:0.85rem; border:1px solid #222;">
                        <span style="color:var(--gold)">BANCO:</span> 0102 - VENEZUELA<br>
                        <span style="color:var(--gold)">TEL√âFONO:</span> 0412-4209277<br>
                        <span style="color:var(--gold)">C.I:</span> 30.041.715
                    </div>
                    <button class="btn btn-gold" style="width:100%; margin:20px 0 0 0; font-size:0.8rem;" onclick="alert('Notificaci√≥n enviada al administrador. Tu saldo se actualizar√° en breve.')">NOTIFICAR PAGO REALIZADO</button>
                </div>

                <div class="bank-card">
                    <h3 style="font-size:1.1rem; margin-top:0;">RETIRAR GANANCIAS</h3>
                    <p id="bank-info-display" style="font-size:0.8rem; color:var(--gold-light); font-weight:bold;"></p>
                    <input type="number" id="wit-val" placeholder="CANTIDAD DE BC A RETIRAR" style="width:100%; padding:12px; background:transparent; border:1px solid #444; color:white; margin-top:10px;">
                    <button class="btn btn-outline" style="width:100%; margin:20px 0 0 0; font-size:0.8rem;" onclick="processWithdraw()">SOLICITAR RETIRO</button>
                </div>
            </div>

            <h3 style="margin-top:40px; font-size:1.1rem;">HISTORIAL RECIENTE DE JUEGO</h3>
            <div style="max-height:300px; overflow-y:auto; border:1px solid #222;">
                <table class="history-table">
                    <thead>
                        <tr>
                            <th>JUEGO</th>
                            <th>APUESTA</th>
                            <th>RESULTADO</th>
                            <th>HORA</th>
                        </tr>
                    </thead>
                    <tbody id="hist-body">
                        </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        /* --- GESTI√ìN DE SONIDOS --- */
        const audioSystem = {
            card: new Audio('https://www.soundjay.com/buttons/button-16.mp3'),
            win: new Audio('https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3'),
            lose: new Audio('https://www.soundjay.com/buttons/button-11.mp3'),
            spin: new Audio('https://www.soundjay.com/buttons/button-48.mp3'),
            coins: new Audio('https://www.soundjay.com/misc/sounds/coin-drop-1.mp3')
        };

        function playSound(type) {
            try {
                audioSystem[type].currentTime = 0;
                audioSystem[type].play();
            } catch(e) { console.warn("Audio no disponible"); }
        }

        /* --- N√öCLEO DEL SISTEMA --- */
        let database = JSON.parse(localStorage.getItem('blackvip_final_v1')) || {};
        let currentUser = null;
        let isRegistering = false;

        function toggleAuth() {
            isRegistering = !isRegistering;
            document.getElementById('auth-main-title').innerText = isRegistering ? "REGISTRO VIP" : "BLACK VIP CASINO";
            document.getElementById('reg-fields').style.display = isRegistering ? "block" : "none";
        }

        function processAuth() {
            const user = document.getElementById('user-in').value.trim();
            const pass = document.getElementById('pass-in').value.trim();

            if(!user || !pass) return alert("Por favor complete los campos.");

            if(isRegistering) {
                const bank = document.getElementById('bank-in').value;
                if(database[user]) return alert("El socio ya existe.");
                database[user] = { pass: pass, bank: bank, balance: 1000, history: [] };
                saveData();
                alert("Membres√≠a creada con √©xito. Ya puede entrar.");
                toggleAuth();
            } else {
                if(database[user] && database[user].pass === pass) {
                    currentUser = user;
                    loginSuccess();
                } else {
                    alert("Credenciales incorrectas.");
                }
            }
        }

        function loginSuccess() {
            document.getElementById('auth-container').style.display = 'none';
            document.getElementById('vip-header').style.display = 'flex';
            document.getElementById('main-content').style.display = 'flex';
            document.getElementById('bank-info-display').innerText = "DESTINO: " + database[currentUser].bank;
            updateBalanceUI();
        }

        function saveData() {
            localStorage.setItem('blackvip_final_v1', JSON.stringify(database));
        }

        function updateBalanceUI() {
            document.getElementById('bal-val').innerText = database[currentUser].balance.toLocaleString();
            saveData();
            renderHistoryTable();
        }

        function addToHistory(gameName, betAmount, resultText) {
            const entry = {
                game: gameName,
                bet: betAmount,
                res: resultText,
                time: new Date().toLocaleTimeString()
            };
            database[currentUser].history.unshift(entry);
            updateBalanceUI();
        }

        function renderHistoryTable() {
            const container = document.getElementById('hist-body');
            if(!container) return;
            container.innerHTML = database[currentUser].history.map(item => `
                <tr>
                    <td>${item.game}</td>
                    <td>${item.bet} BC</td>
                    <td style="color:${item.res.includes('+') ? 'var(--green-casino)' : 'var(--red-casino)'}; font-weight:bold;">
                        ${item.res}
                    </td>
                    <td>${item.time}</td>
                </tr>
            `).join('');
        }

        /* --- CONTROL DE MODALES --- */
        function openGame(id) {
            closeAll();
            document.getElementById('modal-' + id).style.display = 'flex';
        }

        function openBank() {
            closeAll();
            document.getElementById('modal-bank').style.display = 'flex';
        }

        function closeAll() {
            document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');
        }

        /* --- L√ìGICA: RULETA PROFESIONAL --- */
        function playR(userChoice) {
            if(database[currentUser].balance < 50) return alert("Saldo insuficiente.");
            
            database[currentUser].balance -= 50;
            updateBalanceUI();

            const wheel = document.getElementById('r-wheel');
            const status = document.getElementById('r-status');
            status.innerText = "¬°LA BOLA EST√Å GIRANDO!";
            status.className = "status-msg";
            playSound('spin');

            const spinDegrees = 2500 + Math.floor(Math.random() * 1000);
            wheel.style.transform = `rotate(${spinDegrees}deg)`;

            setTimeout(() => {
                const finalAngle = spinDegrees % 360;
                let winColor;

                // L√≥gica honesta basada en los segmentos del gradiente CSS
                if(finalAngle >= 0 && finalAngle <= 9) {
                    winColor = 'verde';
                } else if((finalAngle % 19.4) < 9.7) {
                    winColor = 'rojo';
                } else {
                    winColor = 'negro';
                }

                if(userChoice === winColor) {
                    database[currentUser].balance += 100;
                    status.innerText = "¬°VICTORIA! +100 BC";
                    status.classList.add('win-anim');
                    playSound('win');
                    addToHistory('Ruleta Royal', 50, '+100');
                } else {
                    status.innerText = "CAY√ì EN " + winColor.toUpperCase();
                    status.classList.add('lose-anim');
                    playSound('lose');
                    addToHistory('Ruleta Royal', 50, '-50');
                }
                updateBalanceUI();
            }, 6000);
        }

        /* --- L√ìGICA: BLACKJACK 21 --- */
        let playerHand = [], dealerHand = [];
        const cardValues = { '2':2,'3':3,'4':4,'5':5,'6':6,'7':7,'8':8,'9':9,'10':10,'J':10,'Q':10,'K':10,'A':11 };

        function getRandomCard() {
            const cards = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
            return cards[Math.floor(Math.random() * cards.length)];
        }

        function calculateScore(hand) {
            let score = 0, aces = 0;
            hand.forEach(c => {
                score += cardValues[c];
                if(c === 'A') aces++;
            });
            while(score > 21 && aces > 0) {
                score -= 10;
                aces--;
            }
            return score;
        }

        function startB() {
            if(database[currentUser].balance < 50) return;
            database[currentUser].balance -= 50;
            updateBalanceUI();

            playerHand = [getRandomCard(), getRandomCard()];
            dealerHand = [getRandomCard(), getRandomCard()];

            document.getElementById('b-start').disabled = true;
            document.getElementById('b-hit').disabled = false;
            document.getElementById('b-stand').disabled = false;
            document.getElementById('b-status').innerText = "TU TURNO: ¬øPIDES O TE PLANTAS?";
            document.getElementById('b-status').className = "status-msg";
            
            playSound('card');
            renderBlackjackUI(false);
        }

        function renderBlackjackUI(showAll) {
            const pArea = document.getElementById('b-player');
            const dArea = document.getElementById('b-dealer');

            pArea.innerHTML = playerHand.map(c => `<div style="width:70px; height:100px; background:white; color:black; border-radius:8px; display:flex; align-items:center; justify-content:center; font-weight:bold; font-size:1.8rem; border:2px solid var(--gold); shadow: 4px 4px 10px black;">${c}</div>`).join('');
            
            if(showAll) {
                dArea.innerHTML = dealerHand.map(c => `<div style="width:70px; height:100px; background:#eee; color:black; border-radius:8px; display:flex; align-items:center; justify-content:center; font-weight:bold; font-size:1.8rem; border:2px solid var(--gold);">${c}</div>`).join('');
            } else {
                dArea.innerHTML = `<div style="width:70px; height:100px; background:#eee; color:black; border-radius:8px; display:flex; align-items:center; justify-content:center; font-weight:bold; font-size:1.8rem; border:2px solid var(--gold);">${dealerHand[0]}</div><div style="width:70px; height:100px; background:var(--purple-vip); border-radius:8px; border:2px solid var(--gold);"></div>`;
            }
        }

        function hitB() {
            playerHand.push(getRandomCard());
            playSound('card');
            renderBlackjackUI(false);
            if(calculateScore(playerHand) > 21) {
                finishBlackjack("TE PASASTE DE 21", "-50");
                playSound('lose');
            }
        }

        function standB() {
            while(calculateScore(dealerHand) < 17) {
                dealerHand.push(getRandomCard());
            }
            renderBlackjackUI(true);
            const pScore = calculateScore(playerHand);
            const dScore = calculateScore(dealerHand);

            if(dScore > 21 || pScore > dScore) {
                database[currentUser].balance += 100;
                finishBlackjack("¬°GANASTE LA MANO!", "+100");
                playSound('win');
            } else if(pScore === dScore) {
                database[currentUser].balance += 50;
                finishBlackjack("EMPATE T√âCNICO", "0");
            } else {
                finishBlackjack("LA CASA GANA", "-50");
                playSound('lose');
            }
        }

        function finishBlackjack(msg, res) {
            const st = document.getElementById('b-status');
            st.innerText = msg;
            st.className = res.includes('+') ? "status-msg win-anim" : "status-msg lose-anim";
            document.getElementById('b-start').disabled = false;
            document.getElementById('b-hit').disabled = true;
            document.getElementById('b-stand').disabled = true;
            addToHistory('Blackjack 21', 50, res);
        }

        /* --- L√ìGICA: AVIATOR PRO --- */
        let crashInterval, currentMult = 1.0, isFlying = false;

        function startC() {
            if(database[currentUser].balance < 100) return;
            database[currentUser].balance -= 100;
            updateBalanceUI();

            isFlying = true;
            currentMult = 1.0;
            document.getElementById('c-start').disabled = true;
            document.getElementById('c-cash').disabled = false;
            document.getElementById('c-status').innerText = "EL AVI√ìN EST√Å SUBIENDO...";
            document.getElementById('c-status').className = "status-msg";

            let crashPoint = 1.1 + (Math.random() * 3.5);

            crashInterval = setInterval(() => {
                currentMult += 0.04;
                document.getElementById('c-mult').innerText = currentMult.toFixed(2) + "x";
                
                if(currentMult >= crashPoint) {
                    clearInterval(crashInterval);
                    isFlying = false;
                    document.getElementById('c-status').innerText = "¬°EL AVI√ìN SE FUE!";
                    document.getElementById('c-status').className = "status-msg lose-anim";
                    playSound('lose');
                    addToHistory('Aviator Pro', 100, '-100');
                    document.getElementById('c-start').disabled = false;
                    document.getElementById('c-cash').disabled = true;
                }
            }, 100);
        }

        function cashC() {
            if(!isFlying) return;
            clearInterval(crashInterval);
            isFlying = false;
            let winAmount = Math.floor(100 * currentMult);
            database[currentUser].balance += winAmount;
            
            document.getElementById('c-status').innerText = "¬°COBRASTE " + winAmount + " BC!";
            document.getElementById('c-status').className = "status-msg win-anim";
            playSound('coins');
            addToHistory('Aviator Pro', 100, '+' + winAmount);
            
            document.getElementById('c-start').disabled = false;
            document.getElementById('c-cash').disabled = true;
        }

        /* --- L√ìGICA: LUCKY SLOTS --- */
        function playS() {
            if(database[currentUser].balance < 20) return;
            database[currentUser].balance -= 20;
            updateBalanceUI();
            playSound('spin');

            const reels = [document.getElementById('sl1'), document.getElementById('sl2'), document.getElementById('sl3')];
            const items = ['üçí','üíé','7Ô∏è‚É£','üîî','üçá'];

            let timer = setInterval(() => {
                reels.forEach(r => r.innerText = items[Math.floor(Math.random()*items.length)]);
            }, 100);

            setTimeout(() => {
                clearInterval(timer);
                const results = reels.map(r => {
                    let res = items[Math.floor(Math.random()*items.length)];
                    r.innerText = res;
                    return res;
                });

                if(results[0] === results[1] && results[1] === results[2]) {
                    database[currentUser].balance += 500;
                    document.getElementById('s-status').innerText = "¬°JACKPOT +500 BC!";
                    document.getElementById('s-status').className = "status-msg win-anim";
                    playSound('win');
                    addToHistory('Lucky Slots', 20, '+500');
                } else {
                    document.getElementById('s-status').innerText = "SIGUE INTENTANDO";
                    playSound('lose');
                    addToHistory('Lucky Slots', 20, '-20');
                }
            }, 1500);
        }

        /* --- L√ìGICA: MINAS VIP --- */
        let minePositions = [], foundDiamonds = 0, mineActive = false;

        function startM() {
            if(database[currentUser].balance < 100) return;
            database[currentUser].balance -= 100;
            updateBalanceUI();

            mineActive = true;
            foundDiamonds = 0;
            minePositions = Array(25).fill(false);
            let minesPlaced = 0;
            while(minesPlaced < 4) {
                let idx = Math.floor(Math.random() * 25);
                if(!minePositions[idx]) { minePositions[idx] = true; minesPlaced++; }
            }

            const grid = document.getElementById('m-grid');
            grid.innerHTML = '';
            for(let i=0; i<25; i++) {
                let cell = document.createElement('div');
                cell.style = "width:100%; aspect-ratio:1; background:#222; border-radius:8px; display:flex; align-items:center; justify-content:center; cursor:pointer; font-size:1.5rem; transition:0.2s;";
                cell.onclick = () => revealMine(i, cell);
                grid.appendChild(cell);
            }
            document.getElementById('m-start').disabled = true;
            document.getElementById('m-cash').disabled = false;
        }

        function revealMine(idx, element) {
            if(!mineActive || element.innerText !== '') return;
            if(minePositions[idx]) {
                element.innerText = 'üí£';
                element.style.background = 'var(--red-casino)';
                mineActive = false;
                document.getElementById('m-status').innerText = "¬°EXPLOSI√ìN! -100 BC";
                document.getElementById('m-status').className = "status-msg lose-anim";
                playSound('lose');
                addToHistory('Minas VIP', 100, '-100');
                document.getElementById('m-start').disabled = false;
                document.getElementById('m-cash').disabled = true;
            } else {
                element.innerText = 'üíé';
                element.style.background = 'var(--green-casino)';
                foundDiamonds++;
                playSound('card');
            }
        }

        function cashM() {
            if(!mineActive) return;
            mineActive = false;
            let win = Math.floor(100 * (1 + foundDiamonds * 0.7));
            database[currentUser].balance += win;
            document.getElementById('m-status').innerText = "RETIRASTE +" + win + " BC";
            document.getElementById('m-status').className = "status-msg win-anim";
            playSound('coins');
            addToHistory('Minas VIP', 100, '+' + win);
            document.getElementById('m-start').disabled = false;
            document.getElementById('m-cash').disabled = true;
        }

        function processWithdraw() {
            const val = parseInt(document.getElementById('wit-val').value);
            if(!val || val <= 0) return alert("Ingrese monto v√°lido.");
            if(val > database[currentUser].balance) return alert("Saldo insuficiente.");
            
            database[currentUser].balance -= val;
            addToHistory('Retiro Cajero', val, 'Pendiente');
            alert("Su solicitud por " + val + " BC ha sido registrada.");
        }
    </script>
</body>
</html>